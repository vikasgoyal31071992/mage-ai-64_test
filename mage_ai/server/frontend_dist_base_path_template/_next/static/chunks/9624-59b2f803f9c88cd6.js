"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9624],{29624:function(e,n,i){i.d(n,{Z:function(){return Q}});var t=i(82394),l=i(75582),r=i(12691),u=i.n(r),o=i(82684),c=i(69864),s=i(34376),p=i(71180),d=i(50724),a=i(30160),f=i(44897),h=i(42631),g=i(70515),v=i(25976),_=v.default.div.withConfig({displayName:"indexstyle__ModalStyle",componentId:"sc-qldrgc-0"})(["position:absolute;"," "," display:flex;flex-direction:column;width:","px;overflow:hidden;background-color:",";border:1px solid ",";border-radius:","px;box-shadow:",";"],(function(e){return e.top&&"\n    top: ".concat(e.top,"px;\n  ")}),(function(e){return e.left&&"\n    left: ".concat(e.left,"px;\n  ")}),39*g.iI,(function(e){return(e.theme||f.Z).background.dashboard}),(function(e){return(e.theme||f.Z).borders.darkLight}),h.n_,(function(e){return(e.theme||f.Z).shadow.popup})),x=v.default.div.withConfig({displayName:"indexstyle__ContentStyle",componentId:"sc-qldrgc-1"})(["display:flex;flex-direction:column;gap:","px;padding:","px ","px;"],2*g.iI,2.5*g.iI,2*g.iI),j=v.default.div.withConfig({displayName:"indexstyle__ActionsStyle",componentId:"sc-qldrgc-2"})(["display:flex;gap:","px;padding:","px;background-color:",";border-top:1px solid ",";& > *{flex:1;}"],g.iI,2*g.iI,(function(e){return(e.theme||f.Z).background.panel}),(function(e){return(e.theme||f.Z).borders.darkLight})),y=i(72473),b=i(72191),m=i(79633),Z=i(81728),C=i(28598);var P=function(e){var n=e.inProgressRunsCount,i=e.left,t=void 0===i?0:i,l=e.onAllow,r=e.onStop,u=e.pipelineScheduleId,c=e.pipelineUuid,s=e.top,d=void 0===s?0:s,f=e.topOffset,h=void 0===f?0:f,v=(0,o.useRef)(null),P=(0,o.useState)(d+h),k=P[0],w=P[1];return(0,o.useEffect)((function(){var e=null!==v&&void 0!==v&&v.current?v.current.getBoundingClientRect().height:32*g.iI,n=d+h+e>window.innerHeight;w(n?d-e:d+h)}),[t,d,h]),(0,C.jsxs)(_,{left:t,ref:v,top:k,children:[(0,C.jsxs)(x,{children:[(0,C.jsx)(y.AlertTriangle,{fill:m.$R,size:b.nz}),(0,C.jsx)(a.ZP,{bold:!0,large:!0,warning:!0,children:"There ".concat(1===n?"is":"are"," currently ").concat((0,Z._6)("run",n,!0)," in progress.")}),(0,C.jsx)(a.ZP,{large:!0,children:"Do you want to stop or allow the ".concat((0,Z._6)("run",n,!0,!0)," to complete?")})]}),(0,C.jsxs)(j,{children:[(0,C.jsx)(p.ZP,{large:!0,onClick:function(){return r(u,c)},children:"Stop"}),(0,C.jsx)(p.ZP,{large:!0,onClick:function(){return l(u)},children:"Allow"})]})]})},k=i(55485),w=i(48670),O=i(30229),I=i(89515),S=i(38276),R=i(75499),A=i(48381),E=i(69650),D=i(12468),N=i(35686),T=i(77417),q=i(19698),L=i(81655),U=i(41143),z=i(31608),B=i(16488),V=i(3917),F=i(50178),H=i(72619),X=i(95924),$=i(70320),G=i(89538);function K(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function M(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?K(Object(i),!0).forEach((function(n){(0,t.Z)(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):K(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}var J=1.5*g.iI;var Q=function(e){var n=e.disableActions,i=e.fetchPipelineSchedules,t=e.highlightRowOnHover,r=e.includeCreatedAtColumn,f=e.includePipelineColumn,h=e.pipeline,g=e.pipelineSchedules,v=e.pipelineTriggersByName,_=e.selectedSchedule,x=e.setErrors,j=e.setSelectedSchedule,m=e.stickyHeader,Z=null===h||void 0===h?void 0:h.uuid,K=(0,s.useRouter)(),Q=(0,T.Z)().projectPlatformActivated,W=(0,q.Z)().status,Y=(0,o.useRef)({}),ee=(0,o.useRef)({}),ne=(0,o.useState)(null),ie=ne[0],te=ne[1],le=(0,o.useState)(0),re=le[0],ue=le[1],oe=(0,o.useState)(0),ce=oe[0],se=oe[1],pe=(0,$.qB)(),de=pe?L.O$:{},ae=(0,c.Db)((function(e){return N.ZP.pipelines.useUpdate(e.uuid)({pipeline:e})}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null===i||void 0===i||i()},onErrorCallback:function(e,n){return null===x||void 0===x?void 0:x({errors:n,response:e})}})}}),fe=(0,l.Z)(ae,1)[0],he=(0,c.Db)((function(e){return N.ZP.pipeline_schedules.useUpdate(e.id)({pipeline_schedule:e})}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null===i||void 0===i||i()},onErrorCallback:function(e,n){return null===x||void 0===x?void 0:x({errors:n,response:e})}})}}),ge=(0,l.Z)(he,1)[0],ve=(0,c.Db)((function(e){return N.ZP.pipeline_schedules.useDelete(e)()}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null===i||void 0===i||i(),Z?K.push("/pipelines/[pipeline]/triggers","/pipelines/".concat(Z,"/triggers")):null===i||void 0===i||i()},onErrorCallback:function(e,n){return x({errors:n,response:e})}})}}),_e=(0,l.Z)(ve,1)[0],xe=[],je=[];n||(xe.push.apply(xe,[null,null,null]),je.push.apply(je,[{uuid:"Active"},{uuid:"Type"},{center:!0,uuid:"Logs"}])),Q&&(xe.push.apply(xe,[null]),je.push.apply(je,[{uuid:"Project"}])),xe.push.apply(xe,[1,2]),je.push.apply(je,[{uuid:"Name"},{uuid:"Description"}]),n||(xe.push.apply(xe,[null]),je.push({uuid:"Frequency"})),xe.push.apply(xe,[1,1,null]),je.push.apply(je,[M(M({},de),{},{uuid:"Next run date"}),{uuid:"Latest status"},{uuid:"Runs"}]),n||(xe.push.apply(xe,[1]),je.push({uuid:"Tags"})),n||(0,F.Ct)()||(xe.push.apply(xe,[null]),je.push({label:function(){return""},uuid:"edit/delete"})),!n&&f&&(je.splice(2,0,{uuid:"Pipeline"}),xe.splice(2,0,1)),!n&&r&&(je.splice(5,0,M(M({},de),{},{uuid:"Created at"})),xe.splice(5,0,null));var ye=(0,G.dd)((function(e){var n=e.inProgressRunsCount,i=e.left,t=e.pipelineScheduleId,l=e.pipelineUuid,r=e.top,u=e.topOffset;return(0,C.jsx)(P,{inProgressRunsCount:n,left:i,onAllow:function(e){Ze(),ge({id:e,status:O.fq.INACTIVE})},onStop:function(e,n){Ze(),fe({pipeline_schedule_id:e,status:U.V.CANCELLED,uuid:n}),ge({id:e,status:O.fq.INACTIVE})},pipelineScheduleId:t,pipelineUuid:l,top:r,topOffset:u})}),{},[],{background:!0,uuid:"disable_trigger"}),be=(0,l.Z)(ye,2),me=be[0],Ze=be[1];return(0,C.jsx)(z.cl,{overflowVisible:!0,children:0===g.length?(0,C.jsx)(S.Z,{px:3,py:1,children:(0,C.jsx)(a.ZP,{bold:!0,default:!0,monospace:!0,muted:!0,children:"No triggers available"})}):(0,C.jsx)(R.Z,{columnFlex:xe,columns:je,highlightRowOnHover:t,isSelectedRow:function(e){return g[e].id===(null===_||void 0===_?void 0:_.id)},onClickRow:j?function(e){return null===j||void 0===j?void 0:j(g[e])}:null,rowVerticalPadding:6,rows:g.map((function(e,i){var t=e.id,l=e.created_at,c=e.description,s=e.next_pipeline_run_date,h=e.pipeline_in_progress_runs_count,g=e.pipeline_runs_count,_=e.pipeline_uuid,x=e.last_pipeline_run_status,j=e.name,m=e.repo_path,P=e.schedule_interval,R=e.status,N=e.tags,T=O.fq.ACTIVE===R,q=(0,B._U)(P),U=Z||_;Y.current[t]=(0,o.createRef)(),ee.current[t]=(0,o.createRef)();var z=null!==v&&void 0!==v&&v[j]?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(S.Z,{mr:1}),(0,C.jsx)(D.Z,{block:!0,label:"This trigger is saved in code.",size:J,widthFitContent:!0,children:(0,C.jsx)(y.Code,{default:!0,size:J})})]}):null,H=[];if(n)H.push.apply(H,[(0,C.jsxs)(k.ZP,{alignItems:"center",children:[(0,C.jsx)(a.ZP,{bold:!0,children:j}),z]},"trigger_name_".concat(i))]);else{var $,G;if(H.push.apply(H,[(0,C.jsx)(D.Z,{block:!0,label:R,size:20,widthFitContent:!0,children:(0,C.jsx)("div",{ref:Y.current[t],style:{position:"relative"},children:(0,C.jsx)(E.Z,{checked:T,compact:!0,onCheck:function(e){return function(e){var n=e.event,i=e.inProgressRunsCount,t=e.pipelineIsActive,l=e.pipelineScheduleId,r=e.pipelineUuid;if((0,X.j)(n),t&&i>0){var u,o=null===(u=Y.current[l])||void 0===u?void 0:u.current,c=null===o||void 0===o?void 0:o.getBoundingClientRect(),s=c.height,p=c.left,d=c.top;me({inProgressRunsCount:i,left:p,pipelineScheduleId:l,pipelineUuid:r,top:d,topOffset:s})}else ge({id:l,status:t?O.fq.INACTIVE:O.fq.ACTIVE})}({event:e,inProgressRunsCount:h,pipelineIsActive:T,pipelineScheduleId:t,pipelineUuid:_})},purpleBackground:!0})})},"trigger_enabled_".concat(i)),(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:null===($=O.Z4[e.schedule_type])||void 0===$?void 0:$.call(O.Z4)},"trigger_type_".concat(i))]),H.push((0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return K.push("/pipelines/".concat(U,"/logs?pipeline_schedule_id[]=").concat(t))},children:(0,C.jsx)(y.Logs,{default:!0,size:b.bL})},"logs_button_".concat(i))),Q)H.push.apply(H,[(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:null===m||void 0===m||null===(G=m.replace((null===W||void 0===W?void 0:W.repo_path_root)||"",""))||void 0===G?void 0:G.slice(1)},"project_".concat(i))]);H.push.apply(H,[(0,C.jsxs)(k.ZP,{alignItems:"center",children:[(0,C.jsx)(u(),{as:"/pipelines/".concat(U,"/triggers/").concat(t),href:"/pipelines/[pipeline]/triggers/[...slug]",passHref:!0,children:(0,C.jsx)(w.Z,{bold:!0,onClick:function(e){(0,X.j)(e),K.push("/pipelines/[pipeline]/triggers/[...slug]","/pipelines/".concat(U,"/triggers/").concat(t))},sky:!0,children:j})}),z]},"trigger_name_".concat(i))])}return H.push.apply(H,[(0,C.jsx)(a.ZP,{default:!0,children:c},"trigger_description_".concat(i))]),n||H.push((0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:pe&&q?(0,B.lO)(P):P},"trigger_frequency_".concat(i))),H.push.apply(H,[(0,C.jsx)(a.ZP,{monospace:!0,small:!0,title:s?"UTC: ".concat(s.slice(0,19)):null,children:s?pe?(0,V.XG)(s,pe):(0,V.d$)(s,{includeSeconds:!0,utcFormat:!0}):(0,C.jsx)(C.Fragment,{children:"\u2014"})},"trigger_next_run_date_".concat(i)),(0,o.createElement)(a.ZP,M(M({},(0,L.NC)(x)),{},{key:"latest_run_status_".concat(i)}),x||"N/A"),(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:g||"0"},"trigger_run_count_".concat(i))]),n||H.push((0,C.jsx)("div",{children:(0,C.jsx)(A.Z,{tags:null===N||void 0===N?void 0:N.map((function(e){return{uuid:e}}))})},"pipeline_tags_".concat(i))),n||(0,F.Ct)()||H.push((0,C.jsxs)(k.ZP,{children:[(0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return K.push("/pipelines/".concat(U,"/triggers/").concat(t,"/edit"))},title:"Edit",children:(0,C.jsx)(y.Edit,{default:!0,size:b.bL})}),(0,C.jsx)(S.Z,{mr:1}),(0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){var e,n,i,l;te(t),ue((null===(e=ee.current[t])||void 0===e||null===(n=e.current)||void 0===n?void 0:n.offsetTop)||0),se((null===(i=ee.current[t])||void 0===i||null===(l=i.current)||void 0===l?void 0:l.offsetLeft)||0)},ref:ee.current[t],title:"Delete",children:(0,C.jsx)(y.Trash,{default:!0,size:b.bL})}),(0,C.jsx)(d.Z,{onClickOutside:function(){return te(null)},open:ie===t,children:(0,C.jsx)(I.Z,{danger:!0,left:(ce||0)-L.nH,onCancel:function(){return te(null)},onClick:function(){te(null),_e(t)},title:"Are you sure you want to delete the trigger ".concat(j,"?"),top:(re||0)-(i<=1?L.oz:L.OK),width:L.Xx})})]},"edit_delete_buttons_".concat(i))),!n&&f&&H.splice(2,0,(0,C.jsx)(a.ZP,{default:!0,monospace:!0,children:U},"pipeline_name_".concat(i))),!n&&r&&H.splice(5,0,(0,C.jsx)(a.ZP,{default:!0,monospace:!0,small:!0,title:l?(0,V._6)(l):null,children:(0,V.XG)(null===l||void 0===l?void 0:l.slice(0,19),pe)},"created_at_".concat(i))),H})),stickyHeader:m,uuid:"pipeline-triggers"})})}}}]);